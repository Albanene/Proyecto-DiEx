---
title: "Proyecto"
output: html_notebook
---
  
```{r include=FALSE}
library(pwr)
library(dplyr)
library(ggplot2)
library(tidyr)
```

```{r}
epilepsy <- MASS::epil
epilepsy
```

##Poder del diseño muestral
```{r}
pwr.t.test(n = NULL,
           d = 0.2,
           sig.level = 0.05,
           type = "one.sample",
           alternative = "greater",
           power = 0.2)
```

##Subdivisión en grupos

```{r}
ep_filtered <- epilepsy %>% 
  filter(base >= 10, trt == "placebo" |trt == "progabide") %>% 
  mutate(
    grupos = case_when(
      age < 30 & trt == "placebo" ~ "Grupo1",
      age >= 30 & trt == "placebo" ~ "Grupo2",
      age < 30 & trt == "progabide" ~ "Grupo3",
      age >= 30 & trt == "progabide" ~ "Grupo4", 
      TRUE ~ as.character(NA)
    ))
```



> nota: revisar que no haya duplicado

```{r}
ep_resumen <- ep_filtered %>% 
  group_by(grupos, subject) %>% 
  summarise(at_totales = sum(y), at_base = unique(base)) %>% 
  mutate(
    grupos = factor(
      grupos, 
      levels = c("Grupo1", "Grupo2", "Grupo3", "Grupo4"), 
      labels = c("Grupo1", "Grupo2", "Grupo3", "Grupo4")
    ), 
    subject = factor(
      subject, 
      levels = sort(subject),
      labels = sort(subject),
    ))
```

```{r}
ep_resumen
```

> nota: guardar en una variable

```{r}
ep_resumen %>% 
  pivot_longer(at_totales:at_base, names_to = "tipos", values_to = "cantidad") %>% 
ggplot() +
  geom_boxplot(aes(x = tipos, y = cantidad, color = grupos))
```
