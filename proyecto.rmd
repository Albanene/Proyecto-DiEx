---
title: "Proyecto"
output: html_notebook
---
  
```{r include=FALSE}
library(pwr)
library(dplyr)

library(ggplot2)
library(tidyr)
```

```{r}
epilepsy <- MASS::epil
epilepsy
```

##Poder del diseño muestral
```{r}
pwr.t.test(n = NULL,
           d = 0.2,
           sig.level = 0.05,
           type = "one.sample",
           alternative = "greater",
           power = 0.2)
```

##Subdivisión en grupos

```{r}
ep_filtered <- epilepsy %>% 
  filter(base >= 10, trt == "placebo" |trt == "progabide") %>% 
  mutate(
    grupos = case_when(
      age < 30 & trt == "placebo" ~ "Grupo1",
      age >= 30 & trt == "placebo" ~ "Grupo2",
      age < 30 & trt == "progabide" ~ "Grupo3",
      age >= 30 & trt == "progabide" ~ "Grupo4", 
      TRUE ~ as.character(NA)
    ))
```


```{r}
ep_resumen <- ep_filtered %>% 
  group_by(grupos, subject) %>% 
  summarise(at_totales = sum(y), at_base = unique(base)) %>% 
  mutate(
    grupos = factor(
      grupos, 
      levels = c("Grupo1", "Grupo2", "Grupo3", "Grupo4"), 
      labels = c("Grupo1", "Grupo2", "Grupo3", "Grupo4")
    ), 
    subject = factor(
      subject, 
      levels = sort(subject),
      labels = sort(subject),
    ))
```

```{r}
ep_resumen
```

##Visualización de datos exploratorios
```{r}
ep_comparacion <- ep_resumen %>% 
  pivot_longer(at_totales:at_base, names_to = "tipos", values_to = "cantidad") 
```

```{r}
ggplot(ep_comparacion) +
  geom_boxplot(aes(x = tipos, y = cantidad, color = grupos)) +
  geom_point(aes(x = tipos, y= cantidad, color = grupos), alpha = 0.5) +
  theme_minimal() +
  facet_grid(.~grupos)
```

##Haciendo pruebas de normalidad
```{r}
Grupo1 <- ep_resumen %>% 
  filter(grupos == "Grupo1")
Grupo2 <- ep_resumen %>% 
  filter(grupos == "Grupo2")
Grupo3 <- ep_resumen %>% 
  filter(grupos == "Grupo3")
Grupo4 <- ep_resumen %>% 
  filter(grupos == "Grupo4")
```

```{r}
shapiro.test(Grupo4$at_totales)
```

```{r}
shapiro.test(Grupo4$at_base)
```

```{r}
#Los ataques durante el tratamiento del grupo 2 y los ataques base del grupo 4 no son normales
```

